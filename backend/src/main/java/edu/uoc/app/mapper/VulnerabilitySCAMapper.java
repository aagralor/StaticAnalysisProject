package edu.uoc.app.mapper;

import java.util.ArrayList;
import java.util.List;
import java.util.stream.Collectors;

import org.springframework.stereotype.Component;

import edu.uoc.app.domain.VulnerabilitySCA;
import edu.uoc.app.domain.sca.json.Vulnerability;

@Component
public class VulnerabilitySCAMapper {

	public VulnerabilitySCA toVulnerabilitySCA(Vulnerability in) {

		VulnerabilitySCA resp = new VulnerabilitySCA();

		resp.setSource(in.getSource());
		resp.setName(in.getName());
		resp.setSeverity(in.getSeverity());
		resp.setCvssv2(in.getCvssv2());
		resp.setCvssv3(in.getCvssv3());
		resp.setCweList(in.getCweList());
		resp.setDescription(in.getDescription());
		resp.setNotes(in.getNotes());
		resp.setReferenceList(in.getReferenceList());
		resp.setVulnerableSoftwareList(
				in.getVulnerableSoftwareList().stream().map(vs -> vs.getSoftware()).collect(Collectors.toList()));

		return resp;
	}

	public List<VulnerabilitySCA> toVulnerabilitySCAList(List<Vulnerability> in) {
		List<VulnerabilitySCA> resp = new ArrayList<VulnerabilitySCA>();

		if (in == null) {
			return resp;
		}

		for (Vulnerability e : in) {
			resp.add(toVulnerabilitySCA(e));
		}

		return resp;
	}

}
